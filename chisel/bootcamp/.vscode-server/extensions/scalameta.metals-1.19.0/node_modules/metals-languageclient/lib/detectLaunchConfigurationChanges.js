"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.detectLaunchConfigurationChanges = void 0;
const UserConfiguration_1 = require("./interfaces/UserConfiguration");
function detectLaunchConfigurationChanges(workspace, promptRestart, additionalRestartKeys = []) {
    workspace.onDidChangeConfiguration((e) => {
        const promptRestartKeys = [
            UserConfiguration_1.UserConfiguration.ServerVersion,
            UserConfiguration_1.UserConfiguration.ServerProperties,
            UserConfiguration_1.UserConfiguration.JavaHome,
            UserConfiguration_1.UserConfiguration.CustomRepositories,
            UserConfiguration_1.UserConfiguration.CoursierMirror,
            ...additionalRestartKeys,
        ];
        const shouldPromptRestart = promptRestartKeys.some((key) => e.affectsConfiguration(`metals.${key}`));
        if (shouldPromptRestart) {
            promptRestart({
                message: "Server launch configuration change detected. Reload the window for changes to take effect",
                reloadWindowChoice: "Reload Window",
                dismissChoice: "Not now",
            });
        }
    });
}
exports.detectLaunchConfigurationChanges = detectLaunchConfigurationChanges;
